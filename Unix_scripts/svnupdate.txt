#! /bin/bash
svnstatus=/tmp/svnstatus
date > $svnstatus
echo "" >> $svnstatus
hostname >> $svnstatus
cd /etc
# add everything
echo "SVN add" >> $svnstatus
/usr/local/bin/svn add --force ./* >> $svnstatus
# remove from svn everything that has been locally removed
echo "SVN status" >> $svnstatus
/usr/local/bin/svn status | grep "^\!" | sed 's/! *//' | xargs -I% svn rm % >> $svnstatus
echo "SVN commit" >> $svnstatus
/usr/local/bin/svn -m "Automatic commit `date`" commit >> $svnstatus
echo "SVN up" >> $svnstatus
/usr/local/bin/svn up >> $svnstatus
echo "Done" >> $svnstatus
errors=`cat $svnstatus | egrep -i 'error|failed|perms|locked|interrupted'`
if [ -n "$errors" ] ; then
mutt -s "SVN problems" vhristev@hristev.com < /tmp/svnstatus
fi

